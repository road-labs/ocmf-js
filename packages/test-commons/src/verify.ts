import { Curve, Hash } from '@road-labs/ocmf-crypto';
import { hexToBytes, stringToBytes } from './utils';

const testCases: {
  name: string;
  curve: Curve;
  signature: string;
  data: string;
  spki: string;
  expected: boolean;
}[] = [
  {
    name: 'basic brainpool256r1',
    curve: 'brainpool256r1',
    signature:
      '3044022008CC0AE0A649F6C0A62A83D7A9E7CAD86128EFD9C17D0B0D2B9FCF68ACB5E32C0220133A4F001B3A7A96A3CBEF45D632AE77277021756BF8ED29758B743E46AF054E',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"79A94A26862469","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:44:54,562+0100 S","TX":"B","RV":0.75727,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:44:54,562+0100 S","TX":"E","RV":3.12961,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '305A301406072A8648CE3D020106092B24030302080101070342000402FC5AE967C115760A1A4D4163AB5E1707E05EEEED5240C0260DAC94515E472D46D00C1A6826A6096E3FE4C7099276356739CF49953F7BFBA9B0152809C82EFC',
    expected: true,
  },
  {
    name: 'basic brainpool384r1',
    curve: 'brainpool384r1',
    signature:
      '306402303962C1A217AE35CDD7FE71D94190548D1538DD393CA3D0E4715B6C62AF7510F08BB86AA8009E617F07B994E9699CAC160230066CBB325DBB8CA08478696FC29B8C17880EFF7A5949B7936708164C131414687E84540F4E767B90ABF4A80BA90CEC35',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"378F6CB530DE1F","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:49:54,598+0100 S","TX":"B","RV":2.10720,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:49:54,598+0100 S","TX":"E","RV":10.10108,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '307A301406072A8648CE3D020106092B240303020801010B036200043FF042476848057BF755A9A4C523729645403DFEA0424EE1BC413A03C572ACDFE08FF3668E4E2C7A0294B451E1E99FF43C3FEA3744741066E8BC4FC54B548AD2F507C94D26F26A92D4A5E3DED7CD68FD3AD783DA95A78300F17D66AA79EB7BF3',
    expected: true,
  },
  {
    name: 'basic secp192k1',
    curve: 'secp192k1',
    signature:
      '3035021900AE388FC887CA23B6B06AA5BF06F728E69FD585EB17F6B3210218301FB1F4B9ECA92568F448B4E64654261DBC1428858D05D5',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"B7869410D6997A","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:58:40,610+0100 S","TX":"B","RV":0.63459,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:58:40,610+0100 S","TX":"E","RV":9.16290,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3046301006072A8648CE3D020106052B8104001F03320004BE63788D9948A823E5A9B6ACC6E2E01A6070A04E51EADA5FB772B897AF96661AAF1C4EFDDC307D9B75AE2F27874ADAA7',
    expected: true,
  },
  {
    name: 'basic secp192r1',
    curve: 'secp192r1',
    signature:
      '303402186F56EE198D2479C2325B5B519BD09CF41FA10D9CB26A44ED02187D7354E413428183616C7F9A0B7AD76AEE249BEBAF2FFF94',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"EBCFD45AF85AD0","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:59:06,631+0100 S","TX":"B","RV":3.41769,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:59:06,631+0100 S","TX":"E","RV":5.05988,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3049301306072A8648CE3D020106082A8648CE3D03010103320004F92AE7DCB6992A14DCF1868FAC99ACF2FA97AA5B7F2886517FE214E3CCED79DD48CD3100D4490EB6CCDB6ED75532EA1D',
    expected: true,
  },
  {
    name: 'basic secp256k1',
    curve: 'secp256k1',
    signature:
      '304402206EECF756F64DC1323CF5456878F3CF781C5458AA93F38B3DF887854697E6F69D02206D3C33C74439FE5257E929E31CAF19107DC079011FFDF198FED284BE9C3F147A',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"3EF6C663C64B31","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:48:06,668+0100 S","TX":"B","RV":3.28289,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:48:06,668+0100 S","TX":"E","RV":8.99225,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3056301006072A8648CE3D020106052B8104000A0342000407A66AFE5715AC3BD4C4952DCF5DEBB4FA437550467A7FE5198E287B1B55AE470FD1A0DC9AF63DD2D1471F90FE1D6820D298788E401E8D0D826A4520C0CF2A9B',
    expected: true,
  },
  {
    name: 'basic secp256r1',
    curve: 'secp256r1',
    signature:
      '3045022100DB41C0B8AC1580F274574DC8A5C9AD856C1A4B0D5BF2252D119F55202E363968022053BD9DBE36DF6EF1F712C76A0E12F80E8B7E614683375C046371871E128B9BA3',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"2AB46E883AD3BB","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:49:47,642+0100 S","TX":"B","RV":0.56698,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:49:47,642+0100 S","TX":"E","RV":8.36706,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3059301306072A8648CE3D020106082A8648CE3D03010703420004EF1766AFD940A49FBA863779837F394EB053BF87DB529DE69FDDE8B32485D7AD715CD8F291656B1DEAA29337A65E4B1B7F9F2808E4E53019B867D4C9294948C9',
    expected: true,
  },
  {
    name: 'basic secp384r1',
    curve: 'secp384r1',
    signature:
      '3065023100FEFA4F66EEEC3138C98FCAD4E61095B5EFF997A8C59DC67CFC99FA198F8EF03BDA5AABE007FDC7E11C30F6591588369E023062B74F89BB0760CFA5E5684159546BF856451D7D36FD1C23583561EFFA56C9FBDA5889B2073911EEE71D94ADBC93BFD0',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"758860AC340B6C","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:56:26,656+0100 S","TX":"B","RV":4.72840,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:56:26,656+0100 S","TX":"E","RV":13.16995,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3076301006072A8648CE3D020106052B8104002203620004CF8D2FF6E863AED11B2A00CC92529358115599FA9066C1F2BDBAFAED820D9E45A71D9CA02047452BB37FA8DB81C4C41DFF20932F5D9E377EA606AA01C59FC4EAB4AB9782FA6A9C819BD741BB320E9A0374F24E5E1ECFA7CCC23B8CF85A9C3701',
    expected: true,
  },
  {
    name: 'signature with different R + S lengths (len(R)=30,len(S)=32)',
    curve: 'secp256r1',
    signature:
      '3042021E1B311FB52832582B75BC2576F4018CFAA47B974F5C103AA0CCEC59A3B6A00220340C254FBC7106541963D6C30930E29C675AF7C1EDB99688874E9AB928512B14',
    data: '{"FV":"1.0","GI":"123","GS":"000","GV":"1.0","PG":"P1","MV":"CS1","MM":"CSOneMeter","MS":"111","MF":"1.0","IS":true,"IT":"ISO14443","ID":"id","RD":[{"TM":"2025-05-24T12:13:57,203+0100 S","TX":"E","RV":87803512,"RI":"1-0:1.8.2","RU":"kWh","RT":"DC","EF":"","ST":"G"}]}',
    spki: '3059301306072A8648CE3D020106082A8648CE3D03010703420004BE3D5E2505B5B207A6357147C49A915EEEACE51771C970202652D57CCB086FE9B46FFB794E0F241CA02935583D2A10A60A75675C2631863E603FB88D413284F5',
    expected: true,
  },
  {
    name: 'signature with R containing sign byte (len(R)=33,len(S)=32)',
    curve: 'secp256r1',
    signature:
      '304502210098FBAE949EA93DA62028AF3F6305DF4AD1BE8CF516AC8808121E53E28E8DFF9502204BAD820D3B9A1ED154516B437FC3CFD53893BB34C234D7B204DA61BF8D26D457',
    data: '{"FV":"1.0","GI":"123","GS":"000","GV":"1.0","PG":"P1","MV":"CS1","MM":"CSOneMeter","MS":"111","MF":"1.0","IS":true,"IT":"ISO14443","ID":"id","RD":[{"TM":"2025-05-24T12:13:57,203+0100 S","TX":"E","RV":5175832,"RI":"1-0:1.8.2","RU":"kWh","RT":"DC","EF":"","ST":"G"}]}',
    spki: '3059301306072A8648CE3D020106082A8648CE3D03010703420004BE3D5E2505B5B207A6357147C49A915EEEACE51771C970202652D57CCB086FE9B46FFB794E0F241CA02935583D2A10A60A75675C2631863E603FB88D413284F5',
    expected: true,
  },
  {
    name: 'signature with S containing sign byte (len(R)=32,len(S)=33)',
    curve: 'secp256r1',
    signature:
      '3045022000EF0D263B3840C1C8A67C19D4477204C28282226142F84B7BA85C8562B0B855022100A15609FE618407447A321240620356248BC01EC7D7F3D9FFD883859AEB50DE72',
    data: '{"FV":"1.0","GI":"123","GS":"000","GV":"1.0","PG":"P1","MV":"CS1","MM":"CSOneMeter","MS":"111","MF":"1.0","IS":true,"IT":"ISO14443","ID":"id","RD":[{"TM":"2025-05-24T12:13:57,203+0100 S","TX":"E","RV":17781109,"RI":"1-0:1.8.2","RU":"kWh","RT":"DC","EF":"","ST":"G"}]}',
    spki: '3059301306072A8648CE3D020106082A8648CE3D03010703420004BE3D5E2505B5B207A6357147C49A915EEEACE51771C970202652D57CCB086FE9B46FFB794E0F241CA02935583D2A10A60A75675C2631863E603FB88D413284F5',
    expected: true,
  },
  {
    name: 'signature with R + S containing sign bytes (len(R)=33,len(S)=33)',
    curve: 'secp256r1',
    signature:
      '3046022100D53794B24476096BC70CEC5D43C1765E95D6093BC64BAD1143A338216862A15F022100E569F11BAC1F1DA729F8D2D2E23BE0DD2D90C06CE9B5CC767BCC031247A0B825',
    data: '{"FV":"1.0","GI":"123","GS":"000","GV":"1.0","PG":"P1","MV":"CS1","MM":"CSOneMeter","MS":"111","MF":"1.0","IS":true,"IT":"ISO14443","ID":"id","RD":[{"TM":"2025-05-24T12:13:57,203+0100 S","TX":"E","RV":30491604,"RI":"1-0:1.8.2","RU":"kWh","RT":"DC","EF":"","ST":"G"}]}',
    spki: '3059301306072A8648CE3D020106082A8648CE3D03010703420004BE3D5E2505B5B207A6357147C49A915EEEACE51771C970202652D57CCB086FE9B46FFB794E0F241CA02935583D2A10A60A75675C2631863E603FB88D413284F5',
    expected: true,
  },
  {
    name: 'tampered payload brainpool256r1',
    curve: 'brainpool256r1',
    signature:
      '3044022008CC0AE0A649F6C0A62A83D7A9E7CAD86128EFD9C17D0B0D2B9FCF68ACB5E32C0220133A4F001B3A7A96A3CBEF45D632AE77277021756BF8ED29758B743E46AF054E',
    data: '{"FV":"2.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"79A94A26862469","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:44:54,562+0100 S","TX":"B","RV":0.75727,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:44:54,562+0100 S","TX":"E","RV":3.12961,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '305A301406072A8648CE3D020106092B24030302080101070342000402FC5AE967C115760A1A4D4163AB5E1707E05EEEED5240C0260DAC94515E472D46D00C1A6826A6096E3FE4C7099276356739CF49953F7BFBA9B0152809C82EFC',
    expected: false,
  },
  {
    name: 'tampered payload brainpool384r1',
    curve: 'brainpool384r1',
    signature:
      '306402303962C1A217AE35CDD7FE71D94190548D1538DD393CA3D0E4715B6C62AF7510F08BB86AA8009E617F07B994E9699CAC160230066CBB325DBB8CA08478696FC29B8C17880EFF7A5949B7936708164C131414687E84540F4E767B90ABF4A80BA90CEC35',
    data: '{"FV":"2.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"378F6CB530DE1F","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:49:54,598+0100 S","TX":"B","RV":2.10720,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:49:54,598+0100 S","TX":"E","RV":10.10108,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '307A301406072A8648CE3D020106092B240303020801010B036200043FF042476848057BF755A9A4C523729645403DFEA0424EE1BC413A03C572ACDFE08FF3668E4E2C7A0294B451E1E99FF43C3FEA3744741066E8BC4FC54B548AD2F507C94D26F26A92D4A5E3DED7CD68FD3AD783DA95A78300F17D66AA79EB7BF3',
    expected: false,
  },
  {
    name: 'tampered payload secp192k1',
    curve: 'secp192k1',
    signature:
      '3035021900AE388FC887CA23B6B06AA5BF06F728E69FD585EB17F6B3210218301FB1F4B9ECA92568F448B4E64654261DBC1428858D05D5',
    data: '{"FV":"2.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"B7869410D6997A","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:58:40,610+0100 S","TX":"B","RV":0.63459,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:58:40,610+0100 S","TX":"E","RV":9.16290,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3046301006072A8648CE3D020106052B8104001F03320004BE63788D9948A823E5A9B6ACC6E2E01A6070A04E51EADA5FB772B897AF96661AAF1C4EFDDC307D9B75AE2F27874ADAA7',
    expected: false,
  },
  {
    name: 'tampered payload secp192r1',
    curve: 'secp192r1',
    signature:
      '303402186F56EE198D2479C2325B5B519BD09CF41FA10D9CB26A44ED02187D7354E413428183616C7F9A0B7AD76AEE249BEBAF2FFF94',
    data: '{"FV":"2.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"EBCFD45AF85AD0","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:59:06,631+0100 S","TX":"B","RV":3.41769,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:59:06,631+0100 S","TX":"E","RV":5.05988,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3049301306072A8648CE3D020106082A8648CE3D03010103320004F92AE7DCB6992A14DCF1868FAC99ACF2FA97AA5B7F2886517FE214E3CCED79DD48CD3100D4490EB6CCDB6ED75532EA1D',
    expected: false,
  },
  {
    name: 'tampered payload secp256k1',
    curve: 'secp256k1',
    signature:
      '304402206EECF756F64DC1323CF5456878F3CF781C5458AA93F38B3DF887854697E6F69D02206D3C33C74439FE5257E929E31CAF19107DC079011FFDF198FED284BE9C3F147A',
    data: '{"FV":"2.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"3EF6C663C64B31","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:48:06,668+0100 S","TX":"B","RV":3.28289,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:48:06,668+0100 S","TX":"E","RV":8.99225,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3056301006072A8648CE3D020106052B8104000A0342000407A66AFE5715AC3BD4C4952DCF5DEBB4FA437550467A7FE5198E287B1B55AE470FD1A0DC9AF63DD2D1471F90FE1D6820D298788E401E8D0D826A4520C0CF2A9B',
    expected: false,
  },
  {
    name: 'tampered payload secp256r1',
    curve: 'secp256r1',
    signature:
      '3045022100DB41C0B8AC1580F274574DC8A5C9AD856C1A4B0D5BF2252D119F55202E363968022053BD9DBE36DF6EF1F712C76A0E12F80E8B7E614683375C046371871E128B9BA3',
    data: '{"FV":"2.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"2AB46E883AD3BB","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:49:47,642+0100 S","TX":"B","RV":0.56698,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:49:47,642+0100 S","TX":"E","RV":8.36706,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3059301306072A8648CE3D020106082A8648CE3D03010703420004EF1766AFD940A49FBA863779837F394EB053BF87DB529DE69FDDE8B32485D7AD715CD8F291656B1DEAA29337A65E4B1B7F9F2808E4E53019B867D4C9294948C9',
    expected: false,
  },
  {
    name: 'tampered payload secp384r1',
    curve: 'secp384r1',
    signature:
      '3065023100FEFA4F66EEEC3138C98FCAD4E61095B5EFF997A8C59DC67CFC99FA198F8EF03BDA5AABE007FDC7E11C30F6591588369E023062B74F89BB0760CFA5E5684159546BF856451D7D36FD1C23583561EFFA56C9FBDA5889B2073911EEE71D94ADBC93BFD0',
    data: '{"FV":"2.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"758860AC340B6C","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:56:26,656+0100 S","TX":"B","RV":4.72840,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:56:26,656+0100 S","TX":"E","RV":13.16995,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3076301006072A8648CE3D020106052B8104002203620004CF8D2FF6E863AED11B2A00CC92529358115599FA9066C1F2BDBAFAED820D9E45A71D9CA02047452BB37FA8DB81C4C41DFF20932F5D9E377EA606AA01C59FC4EAB4AB9782FA6A9C819BD741BB320E9A0374F24E5E1ECFA7CCC23B8CF85A9C3701',
    expected: false,
  },
  {
    name: 'tampered signature brainpool256r1',
    curve: 'brainpool256r1',
    signature:
      '3044022008CC0AE0A649F6C0A62A83D7A9E7CAD76128EFD9C17D0B0D2B9FCF68ACB5E32C0220133A4F001B3A7A96A3CBEF45D632AE77277021756BF8ED29758B743E46AF054E',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"79A94A26862469","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:44:54,562+0100 S","TX":"B","RV":0.75727,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:44:54,562+0100 S","TX":"E","RV":3.12961,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '305A301406072A8648CE3D020106092B24030302080101070342000402FC5AE967C115760A1A4D4163AB5E1707E05EEEED5240C0260DAC94515E472D46D00C1A6826A6096E3FE4C7099276356739CF49953F7BFBA9B0152809C82EFC',
    expected: false,
  },
  {
    name: 'tampered signature brainpool384r1',
    curve: 'brainpool384r1',
    signature:
      '306402303962C1A217AE35CDD7FE71D94190548D1538DD493CA3D0E4715B6C62AF7510F08BB86AA8009E617F07B994E9699CAC160230066CBB325DBB8CA08478696FC29B8C17880EFF7A5949B7936708164C131414687E84540F4E767B90ABF4A80BA90CEC35',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"378F6CB530DE1F","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:49:54,598+0100 S","TX":"B","RV":2.10720,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:49:54,598+0100 S","TX":"E","RV":10.10108,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '307A301406072A8648CE3D020106092B240303020801010B036200043FF042476848057BF755A9A4C523729645403DFEA0424EE1BC413A03C572ACDFE08FF3668E4E2C7A0294B451E1E99FF43C3FEA3744741066E8BC4FC54B548AD2F507C94D26F26A92D4A5E3DED7CD68FD3AD783DA95A78300F17D66AA79EB7BF3',
    expected: false,
  },
  {
    name: 'tampered signature secp192k1',
    curve: 'secp192k1',
    signature:
      '3035021900AE388FC887CA24B6B06AA5BF06F728E69FD585EB17F6B3210218301FB1F4B9ECA92568F448B4E64654261DBC1428858D05D5',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"B7869410D6997A","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:58:40,610+0100 S","TX":"B","RV":0.63459,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:58:40,610+0100 S","TX":"E","RV":9.16290,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3046301006072A8648CE3D020106052B8104001F03320004BE63788D9948A823E5A9B6ACC6E2E01A6070A04E51EADA5FB772B897AF96661AAF1C4EFDDC307D9B75AE2F27874ADAA7',
    expected: false,
  },
  {
    name: 'tampered signature secp192r1',
    curve: 'secp192r1',
    signature:
      '303402186F56EE198D2479C2335B5B519BD09CF41FA10D9CB26A44ED02187D7354E413428183616C7F9A0B7AD76AEE249BEBAF2FFF94',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"EBCFD45AF85AD0","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:59:06,631+0100 S","TX":"B","RV":3.41769,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:59:06,631+0100 S","TX":"E","RV":5.05988,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3049301306072A8648CE3D020106082A8648CE3D03010103320004F92AE7DCB6992A14DCF1868FAC99ACF2FA97AA5B7F2886517FE214E3CCED79DD48CD3100D4490EB6CCDB6ED75532EA1D',
    expected: false,
  },
  {
    name: 'tampered signature secp256k1',
    curve: 'secp256k1',
    signature:
      '304402206EECF756F64DC1323CF5456877F3CF781C5458AA93F38B3DF887854697E6F69D02206D3C33C74439FE5257E929E31CAF19107DC079011FFDF198FED284BE9C3F147A',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"3EF6C663C64B31","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:48:06,668+0100 S","TX":"B","RV":3.28289,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:48:06,668+0100 S","TX":"E","RV":8.99225,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3056301006072A8648CE3D020106052B8104000A0342000407A66AFE5715AC3BD4C4952DCF5DEBB4FA437550467A7FE5198E287B1B55AE470FD1A0DC9AF63DD2D1471F90FE1D6820D298788E401E8D0D826A4520C0CF2A9B',
    expected: false,
  },
  {
    name: 'tampered signature secp256r1',
    curve: 'secp256r1',
    signature:
      '3045022100DB41C0B8AC1580F273574DC8A5C9AD856C1A4B0D5BF2252D119F55202E363968022053BD9DBE36DF6EF1F712C76A0E12F80E8B7E614683375C046371871E128B9BA3',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"2AB46E883AD3BB","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:49:47,642+0100 S","TX":"B","RV":0.56698,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:49:47,642+0100 S","TX":"E","RV":8.36706,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3059301306072A8648CE3D020106082A8648CE3D03010703420004EF1766AFD940A49FBA863779837F394EB053BF87DB529DE69FDDE8B32485D7AD715CD8F291656B1DEAA29337A65E4B1B7F9F2808E4E53019B867D4C9294948C9',
    expected: false,
  },
  {
    name: 'tampered signature secp384r1',
    curve: 'secp384r1',
    signature:
      '3065023100FEFA4F66EEEC3138C98FCAD3E61095B5EFF997A8C59DC67CFC99FA198F8EF03BDA5AABE007FDC7E11C30F6591588369E023062B74F89BB0760CFA5E5684159546BF856451D7D36FD1C23583561EFFA56C9FBDA5889B2073911EEE71D94ADBC93BFD0',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"758860AC340B6C","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:56:26,656+0100 S","TX":"B","RV":4.72840,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:56:26,656+0100 S","TX":"E","RV":13.16995,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3076301006072A8648CE3D020106052B8104002203620004CF8D2FF6E863AED11B2A00CC92529358115599FA9066C1F2BDBAFAED820D9E45A71D9CA02047452BB37FA8DB81C4C41DFF20932F5D9E377EA606AA01C59FC4EAB4AB9782FA6A9C819BD741BB320E9A0374F24E5E1ECFA7CCC23B8CF85A9C3701',
    expected: false,
  },
  {
    name: 'wrong public key brainpool256r1',
    curve: 'brainpool256r1',
    signature:
      '3044022008CC0AE0A649F6C0A62A83D7A9E7CAD86128EFD9C17D0B0D2B9FCF68ACB5E32C0220133A4F001B3A7A96A3CBEF45D632AE77277021756BF8ED29758B743E46AF054E',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"79A94A26862469","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:44:54,562+0100 S","TX":"B","RV":0.75727,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:44:54,562+0100 S","TX":"E","RV":3.12961,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '305A301406072A8648CE3D020106092B24030302080101070342000469C661761E9D9A110AEE98614E1872792FB3F02EFD6BA5281AEED04F190374B725606605EB86F5BC57BAF72CDBAC442C48F534E7EC51F36DBEBDF55A139A311D',
    expected: false,
  },
  {
    name: 'wrong public key brainpool384r1',
    curve: 'brainpool384r1',
    signature:
      '306402303962C1A217AE35CDD7FE71D94190548D1538DD393CA3D0E4715B6C62AF7510F08BB86AA8009E617F07B994E9699CAC160230066CBB325DBB8CA08478696FC29B8C17880EFF7A5949B7936708164C131414687E84540F4E767B90ABF4A80BA90CEC35',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"378F6CB530DE1F","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:49:54,598+0100 S","TX":"B","RV":2.10720,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:49:54,598+0100 S","TX":"E","RV":10.10108,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '307A301406072A8648CE3D020106092B240303020801010B03620004640466CC299698E2349063BE542B25C2CC59534B4299E36438F15FA811E7ADF02AF57F854EFF06DE9AA89DE1667091B727CB8C2067A5BB463789175B152E5C032E38E0E61C04DF0AAB11B5BC2D0950513FDA4D201BCC9747D19EF290D57C40B7',
    expected: false,
  },
  {
    name: 'wrong public key secp192k1',
    curve: 'secp192k1',
    signature:
      '3035021900AE388FC887CA23B6B06AA5BF06F728E69FD585EB17F6B3210218301FB1F4B9ECA92568F448B4E64654261DBC1428858D05D5',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"B7869410D6997A","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:58:40,610+0100 S","TX":"B","RV":0.63459,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:58:40,610+0100 S","TX":"E","RV":9.16290,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3046301006072A8648CE3D020106052B8104001F033200041D13138B8BE0365FF04D93484CF801BCAB219D37E3D92763A03E8CEF934E47EE8E3CB083FACD2E6F92BE6BD7EE51043E',
    expected: false,
  },
  {
    name: 'wrong public key secp192r1',
    curve: 'secp192r1',
    signature:
      '303402186F56EE198D2479C2325B5B519BD09CF41FA10D9CB26A44ED02187D7354E413428183616C7F9A0B7AD76AEE249BEBAF2FFF94',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"EBCFD45AF85AD0","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:59:06,631+0100 S","TX":"B","RV":3.41769,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:59:06,631+0100 S","TX":"E","RV":5.05988,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3049301306072A8648CE3D020106082A8648CE3D0301010332000409937051869B2F02A0162DB8C57303B11935A540060F99626C6D85BD908058D4EC2CC3A6ECDEC78633D838E1EFE0A0B6',
    expected: false,
  },
  {
    name: 'wrong public key secp256k1',
    curve: 'secp256k1',
    signature:
      '304402206EECF756F64DC1323CF5456878F3CF781C5458AA93F38B3DF887854697E6F69D02206D3C33C74439FE5257E929E31CAF19107DC079011FFDF198FED284BE9C3F147A',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"3EF6C663C64B31","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:48:06,668+0100 S","TX":"B","RV":3.28289,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:48:06,668+0100 S","TX":"E","RV":8.99225,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3056301006072A8648CE3D020106052B8104000A03420004C89F37EE39862217A7D6FBC41E3CC2EF005BCAEDE815D4488CA0ABEFEDE69D34BDA4776DD7F25C7FBAE96C0E29877AEB52FB4132658D79C673B91E5F5D0B675F',
    expected: false,
  },
  {
    name: 'wrong public key secp256r1',
    curve: 'secp256r1',
    signature:
      '3045022100DB41C0B8AC1580F274574DC8A5C9AD856C1A4B0D5BF2252D119F55202E363968022053BD9DBE36DF6EF1F712C76A0E12F80E8B7E614683375C046371871E128B9BA3',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"2AB46E883AD3BB","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:49:47,642+0100 S","TX":"B","RV":0.56698,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:49:47,642+0100 S","TX":"E","RV":8.36706,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3059301306072A8648CE3D020106082A8648CE3D03010703420004BE3D5E2505B5B207A6357147C49A915EEEACE51771C970202652D57CCB086FE9B46FFB794E0F241CA02935583D2A10A60A75675C2631863E603FB88D413284F5',
    expected: false,
  },
  {
    name: 'wrong public key secp384r1',
    curve: 'secp384r1',
    signature:
      '3065023100FEFA4F66EEEC3138C98FCAD4E61095B5EFF997A8C59DC67CFC99FA198F8EF03BDA5AABE007FDC7E11C30F6591588369E023062B74F89BB0760CFA5E5684159546BF856451D7D36FD1C23583561EFFA56C9FBDA5889B2073911EEE71D94ADBC93BFD0',
    data: '{"FV":"1.0","GI":"TEST","GS":"1234567","GV":"1.0.0","PG":"T1","MV":"MV","MM":"MM","MS":"1234567","MF":"1.0","IS":true,"IL":"VERIFIED","IF":["RFID_PLAIN","OCPP_RS_TLS"],"IT":"ISO14443","ID":"758860AC340B6C","CI":"CSONE","CT":"CBIDC","RD":[{"TM":"2025-06-14T08:56:26,656+0100 S","TX":"B","RV":4.72840,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"},{"TM":"2025-06-14T11:56:26,656+0100 S","TX":"E","RV":13.16995,"RI":"1-b","RU":"kWh","EI":1523,"ST":"G"}]}',
    spki: '3076301006072A8648CE3D020106052B81040022036200047EF8E6EBDA4153C5FE0925971EC6A1AA89A2CB5E4F9E9B21F5A9EAF634D062616E808B94EB28ACBA90A50773671C02BD509ACDBB1117E9136020611DBB93464EAD5E18158D2F05C489E605FD7629C6CC6316C600102CD755D91FA3F18627B340',
    expected: false,
  },
];

export function buildVerifyTestCases(curves: Curve[]) {
  return testCases
    .filter((testCase) => curves.includes(testCase.curve))
    .map(({ name, curve, signature, data, spki, expected }) => ({
      name,
      curve,
      signature: hexToBytes(signature),
      data: stringToBytes(data),
      hash: 'SHA-256' as Hash,
      spki: hexToBytes(spki),
      expected,
    }));
}
